## Introduction

Implementation of YOLO v3 object detector in Tensorflow (TF-Slim). This repository  is inspired by [Pawe≈Ç Kapica](https://github.com/mystic123). The full details are in [this paper](https://pjreddie.com/media/files/papers/YOLOv3.pdf).  In this project we cover several segments as follows:<br>
- [x] [YOLO v3 architecture](https://github.com/YunYang1994/tensorflow-yolov3/blob/master/core/yolov3.py)
- [x] Weights converter (util for exporting loaded COCO weights as TF checkpoint)
- [x] Basic working demo
- [x] Data generation pipeline
- [x] Training pipeline


## Train on your own dataset
1. Clone this file
```bashrc
$ git clone https://github.com/YunYang1994/tensorflow-yolov3.git
```
2.  You are supposed  to install some dependencies before getting out hands with these codes.
```bashrc
$ cd tensorflow-yolov3
$ pip install -r ./docs/requirements.txt
```
3. Exporting loaded COCO weights as TF checkpoint(`yolov3.ckpt`) and frozen graph (`yolov3_gpu_nms.pb`) . If you don't have [yolov3.weights](https://github.com/YunYang1994/tensorflow-yolov3/releases/download/v1.0/yolov3.weights). Download and put it in the dir `./checkpoint`
```bashrc
$ python convert_weight.py --convert
```
4. Put your template image under ./data/original_template/ to generate training data. Edit the file ./data/train/train.names to include all the names of classes. Each line is a class. Edit the file Parameters.config for image augmentation.The pipeline  uses the template image provided by the user, default background images and image augmentations to generate training data. Run the script
```bashrc
$ python pipeline_generateData.py
```
5. Train the model
```bashrc
$ python pipeline_train.py
```
6. Test the model
```
$ python video_demo.py # if use camera, set video_path = 0
```
The generated training data and trained models can be downloaded at Baidu disk on request. (Supplement_files_for_github)

## Prepare your own dataset
Two files are required as follows:
- `template.png`
- `class.names`

```
person
bicycle
car
...
toothbrush
```

The following files are generated by codes automatically:
- `train.txt`:

```
xxx/xxx.png 18.19 6.32 424.13 421.83 20 323.86 2.65 640.0 421.94 20
xxx/xxx.png 55.38 132.63 519.84 380.4 16
# image_path x_min y_min x_max y_max class_id  x_min y_min ... class_id
```
- `train_anchors.txt`

```
0.10,0.13, 0.16,0.30, 0.33,0.23, 0.40,0.61, 0.62,0.45, 0.69,0.59, 0.76,0.60,  0.86,0.68,  0.91,0.76
```
- `train.tfrecords`
